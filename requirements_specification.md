# 照片水印添加程序需求规格说明书

## 1. 项目概述

### 1.1 项目名称
照片水印添加程序 (Photo Watermark Tool)

### 1.2 项目背景
南京大学大模型辅助软件工程课程作业1，实现一个命令行程序，为照片批量添加基于EXIF拍摄时间的水印。

### 1.3 开发方式
使用 Vibe Coding 方式开发

## 2. 功能需求

### 2.1 核心功能需求

#### FR-001: 图片路径输入
- **需求描述**: 用户能够通过命令行输入图片文件路径
- **优先级**: 高
- **输入**: 文件或目录路径
- **输出**: 系统接受并验证路径有效性

#### FR-002: EXIF信息读取
- **需求描述**: 读取指定路径下所有图片文件的EXIF信息，提取拍摄时间
- **优先级**: 高
- **处理逻辑**:
  - 扫描目录下的所有图片文件
  - 提取EXIF中的拍摄时间信息
  - 格式化为年月日格式作为水印内容
- **支持格式**: JPG、JPEG、PNG、TIFF等常见图片格式

#### FR-003: 水印样式设置
- **需求描述**: 用户可自定义水印的显示样式
- **优先级**: 高
- **可配置参数**:
  - 字体大小
  - 字体颜色
  - 水印位置（左上角、居中、右下角等）

#### FR-004: 水印添加与保存
- **需求描述**: 将时间水印绘制到图片上并保存
- **优先级**: 高
- **保存规则**:
  - 在原目录下创建 `原目录名_watermark` 子目录
  - 保持原文件名，保存带水印的新图片
  - 保留原图片不变

### 2.2 扩展功能需求

#### FR-005: 批量处理
- **需求描述**: 支持目录下多张图片的批量处理
- **优先级**: 中
- **处理逻辑**: 遍历目录，对每张图片执行水印添加操作

#### FR-006: 错误处理
- **需求描述**: 对无效路径、无EXIF信息、文件权限等异常情况进行处理
- **优先级**: 中
- **处理方式**: 输出错误信息，跳过问题文件继续处理

## 3. 非功能性需求

### 3.1 性能需求
- **NFR-001**: 程序应能在合理时间内完成批量处理（单张图片处理时间 < 5秒）
- **NFR-002**: 内存使用合理，支持处理大尺寸图片

### 3.2 可用性需求
- **NFR-003**: 命令行界面简洁明了，参数设置直观
- **NFR-004**: 提供清晰的使用说明和错误提示

### 3.3 可靠性需求
- **NFR-005**: 程序运行稳定，不会因个别文件问题导致整体崩溃
- **NFR-006**: 保证原始文件不被修改或损坏

### 3.4 兼容性需求
- **NFR-007**: 支持主流操作系统（Windows、Linux、macOS）
- **NFR-008**: 支持常见图片格式的EXIF信息读取

## 4. 系统架构需求

### 4.1 输入接口
- 命令行参数：图片路径
- 配置参数：字体大小、颜色、位置

### 4.2 输出接口
- 带水印的图片文件
- 处理状态信息
- 错误日志

### 4.3 核心模块
- 文件系统操作模块
- EXIF信息读取模块
- 图像处理模块
- 水印绘制模块

## 5. 数据需求

### 5.1 输入数据
- 图片文件（JPG、PNG等格式）
- EXIF元数据
- 用户配置参数

### 5.2 输出数据
- 带水印的图片文件
- 处理日志信息

## 6. 约束条件

### 6.1 技术约束
- 编程语言不限
- 必须为命令行程序
- 需支持EXIF信息读取

### 6.2 业务约束
- 必须保留原始图片
- 水印内容仅限拍摄时间（年月日）
- 输出目录结构固定

## 7. 验收标准

### 7.1 功能验收
- [ ] 能正确读取图片EXIF中的拍摄时间信息
- [ ] 能根据用户设置添加水印到指定位置
- [ ] 能批量处理目录下的所有图片
- [ ] 能在指定目录结构下保存结果

### 7.2 质量验收
- [ ] 程序运行稳定，无崩溃
- [ ] 错误处理完善，提示信息清晰
- [ ] 处理速度满足性能要求
- [ ] 输出图片质量良好

## 8. 风险分析

### 8.1 技术风险
- EXIF信息缺失或格式异常
- 图片格式不支持
- 大文件处理内存溢出

### 8.2 缓解措施
- 实现完善的异常处理机制
- 支持多种图片格式
- 优化内存使用策略